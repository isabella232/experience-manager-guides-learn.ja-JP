---
title: AEM Assets UI の検索の設定
description: AEM Assets UI の検索を設定する方法を説明します。
source-git-commit: 14b835074e2b1847f07887275d2cbb81ddd7541d
workflow-type: tm+mt
source-wordcount: '1578'
ht-degree: 1%

---

# AEM Assets UI の検索の設定 {#id192SC800MY4}

デフォルトでは、AEMは DITA コンテンツを認識しないので、リポジトリ内の DITA コンテンツを検索するメカニズムは提供されません。 また、UUID に基づいてコンテンツを検索する OOTB 機能はありません。 AEMガイドを使用すると、AEMリポジトリに DITA コンテンツ検索および UUID ベースの検索機能を追加できます。

DITA コンテンツ検索の設定には、次のタスクが含まれます。

1. [Assets UI での DITA 要素検索コンポーネントの追加](#id192SF0F50HS)
1. [Assets UI への UUID ベースの検索コンポーネントの追加](#id2034F04K05Z)
1. [ユーザーに権限を付与します](#id192SF0G0RUI)
1. [検索にカスタム要素または属性を追加する](#id192SF0G10YK)
1. [既存のコンテンツからメタデータを抽出](#id192SF0GA0HT)

検索機能を追加するほかに、検索に含めないフォルダーを設定することもできます。 詳しくは、 [検索結果から一時ファイルを除外](#id197AHI0035Z).

## Assets UI での DITA 要素検索コンポーネントの追加 {#id192SF0F50HS}

AEM Assets UI で DITA コンテンツ検索コンポーネントを追加するには、次の手順を実行します。

1. 管理者としてAdobe Experience Managerにログインします。

1. をクリックします。 **Adobe Experience Manager** 上部のリンクをクリックし、「 」を選択します。 **ツール**.

1. 選択 **一般** ツールのリストから、 **Formsを検索** タイル。

1. Adobe Analytics の **Formsを検索** リストで、 **アセット管理者の検索レール**.

1. クリック **編集**.
1. Adobe Analytics の **述語を選択** 」タブで、リストの最後までスクロールします。

1. ドラッグ&amp;ドロップ **DITA 要素の述語** を検索フォーム内の必要な場所に配置します。

   ![](assets/drag-search-predicate.png)

1. クリック **完了** をクリックして変更を保存します。

   Assets UI で「フィルター」オプションにアクセスすると、DITA 要素検索フィルタリングオプションが表示されます。

   ![](assets/search-filter-asset-console.png)


## Assets UI への UUID ベースの検索コンポーネントの追加 {#id2034F04K05Z}

AEM Assets UI に UUID ベースの検索コンポーネントを追加するには、次の手順を実行します。

1. 管理者としてAdobe Experience Managerにログインします。

1. をクリックします。 **Adobe Experience Manager** 上部のリンクをクリックし、「 」を選択します。 **ツール**.

1. 選択 **一般** ツールのリストから、 **Formsを検索** タイル。

1. Adobe Analytics の **Formsを検索** リストで、 **アセット管理者の検索レール**.

1. クリック **編集**.
1. Adobe Analytics の **述語を選択** タブ、選択 **プロパティの述語** をクリックし、検索フォーム内の必要な場所にドラッグ&amp;ドロップします。

1. Adobe Analytics の **設定** 「 」タブで、新しく追加された **プロパティの述語** コンポーネント：

   - **フィールドラベル**: UUID
   - **プロパティ名**: jcr:content/fmUuid
1. クリック **完了** をクリックして変更を保存します。

   Assets UI で「フィルター」オプションにアクセスすると、UUIS ベースの検索フィルタリングオプションが表示されます。


## ユーザーに権限を付与します {#id192SF0G0RUI}

作成者および発行者が Assets UI から検索機能にアクセスするには、明示的な権限を付与される必要があります。 これらの権限を付与しないと、ユーザーは、要素/属性値または UUID に基づいて DITA コンテンツを検索できなくなります。

DITA 検索機能にアクセスするには、次の手順を実行します。

1. ユーザーおよびグループ権限ページにアクセスします。

1. アクセス権を付与するユーザーグループまたは個々のユーザーを検索します。 例えば、作成者グループのすべてのユーザーにアクセス権を付与するには、「 **クエリをフィルター** フィールドとを押します。 **入力**.

   ![](assets/authors-group-permission.png)

1. を選択します。 **作成者** グループ化します。

1. 右側のウィンドウで、 **権限** タブをクリックします。

1. 次のフォルダーの場所に移動します。

   /conf/global/settings/dam/search

1. 以下を行う： **読み取り** 検索フォルダーに対する権限。

   ![](assets/read-permission-authors.png)

1. 「**保存**」をクリックします。


選択したユーザーまたはユーザーグループが、Assets UI の DITA コンテンツ検索機能にアクセスできるようになります。

## 検索にカスタム要素または属性を追加する {#id192SF0G10YK}

DITA 検索が機能するには、DITA コンテンツの一部の前処理が必要です。 この前処理ステップは、個々の DITA マップおよびトピックから選択的なコンテンツを抽出し、インデックスを作成して検索を高速化できます。 内部では、このプロセスは *シリアル化*. DITA ファイルのシリアル化は、コンテンツのアップロード中におこなわれるか、オンデマンドで実行することもできます。 設定ファイルを使用して、各 DITA ファイルのコンテンツのインデックスを作成する量を決定します。 シリアル化ファイルのデフォルトの場所は次のとおりです。

/libs/fmdita/config/serializationconfig.xml

デフォルトの検索設定では、DITA 内のすべての要素と属性を検索できます `prolog` 要素を選択します。 他の要素や属性に基づいて検索する場合は、検索シリアル化ファイルを設定する必要があります。

>[!NOTE]
>
> デフォルトの検索設定を `prolog` 要素を選択した場合は、このプロセスをスキップできます。

このファイルには、属性セットとルールセットの 2 つの主なセクションが含まれています。 ルールセットの節のスニペットを次に示します。

```
<ruleset filetypes="xml dita"><!-- Element rules --><rule xpath="//[contains(@class, 'topic/topic')]/[contains(@class, 'topic/prolog')]//*[not(*)]" text="yes" attributeset="all-attrs" /><!-- Attribute rules --><rule xpath="//[contains(@class, 'topic/topic')]/[contains(@class, 'topic/prolog')]///@[local-name() != 'class']" /></ruleset>
```

「ルールセット」セクションでは、次の項目を指定できます。

- 要素を抽出するルール

- 属性を抽出するルール


ルールは、次の内容で構成されます。

xpath :DITA ファイルから要素または属性を取得する XPath クエリです。 要素ルールのデフォルトの設定では、すべての `prolog` 要素。 また、属性ルールのデフォルト設定では、 `prolog` 要素。 XPath クエリを指定して、検索する要素や属性をシリアル化できます。

XPath クエリには、ドキュメントタイプのクラス名が含まれます。 The `topic/topic` クラスは、トピックタイプの DITA 文書に使用されます。 他の DITA 文書のルールを作成する場合は、次のクラス名を使用する必要があります。

| ドキュメントタイプ | クラス名 |
|-------------|----------|
| トピック | - topic/topic |
| タスク |  — トピック/トピック/タスク |
| 概念 |  — トピック/トピックの概念/概念 |
| 参照 |  — トピック/トピック参照/参照 |
| Map |  — マップ/マップ |

text ：指定した要素内のテキストを検索する場合は、yes 値を指定します。 値として「 」を指定した場合、要素内の属性のみがシリアル化されます。 検索する属性を属性セットセクションで指定する必要があります。

attributeset ：このルールに関連付ける属性セットの ID を指定します。 値 all-attrs は、このルールのすべての属性をシリアル化する必要があることを示す特殊なケースです。

属性セットには、DITA コンテンツ内で検索する属性のリストが含まれます。 属性セットには次の情報が含まれます。

id ：属性セットの一意の ID。 この ID は、ルールセットの attributeset パラメーターで指定されます。

attribute ：検索する属性のリスト。 属性ごとに、 `attribute` 要素を選択します。

次の手順を実行して、検索シリアル化ファイルにカスタム DITA 要素または属性を追加します。

1. パッケージマネージャーを使用して/libs/fmdita/config/serializationconfig.xmlファイルをダウンロードします。

1. オーバーレイノードの `config` フォルダー内の `apps` ノード。

1. 次の場所にある設定ファイルに移動します。 `apps` ノード：

   `/apps/fmdita/config/serializationconfig.xml`

1. 必要な要素または属性ルールセットを追加します。

1. 変更をコミットし、Cloud Manager の (CI/CD) パイプラインを実行して設定の変更をデプロイします。


新しいシリアル化情報が保存され、検索用に有効化されます。 ただし、検索で使用できるようにするには、既存の DITA コンテンツからメタデータを抽出する必要があります。

## 既存のコンテンツからメタデータを抽出 {#id192SF0GA0HT}

デフォルトの検索シリアル化ファイルを変更したら、 *com.adobe.fmdita.config.ConfigManager* バンドルを作成してから、ワークフローを実行してメタデータを抽出します。 これにより、既存の DITA ファイルから必要なメタデータが抽出され、同じメタデータが検索に使用できるようになります。

シリアル化ファイルを更新した後に新しいファイルを作成したり、ファイルを編集したりした場合、そのようなファイルからメタデータが自動的に抽出されます。 メタデータの抽出プロセスは、AEMリポジトリに既に存在するファイルに対してのみ必要です。

既存の DITA ファイルからのメタデータの抽出には、次の 2 つのタスクが必要です。

1. configMgr でのメタデータ抽出オプションの有効化
1. メタデータ抽出ワークフローの実行

に示す手順を使用します。 [設定の上書き](download-install-additional-config-override.md#) をクリックして、設定ファイルを作成します。 設定ファイルで、次の\（プロパティ\）詳細を指定して、メタデータ抽出オプションを設定します。

| PID | プロパティキー | プロパティの値 |
|---|------------|--------------|
| `com.adobe.fmdita.config.ConfigManager` | `dita.serialization` | ブール値\(true/false\)。<br> **デフォルト値**: `false` |

メタデータ抽出ワークフローを実行するには、次の手順を実行します。

1. 管理者としてAdobe Experience Managerにログインします。

1. をクリックします。 **Adobe Experience Manager** 上部のリンクをクリックし、「 」を選択します。 **ツール**.

1. 選択 **ガイド** ツールのリストから、 **DITA メタデータ抽出** タイル。

1. 単一のファイルとその依存関係からメタデータを抽出する場合は、 **ファイルを選択** リンクし、ファイルを参照します。

1. フォルダー内の複数のファイルからメタデータを抽出する場合は、 **フォルダを選択** 必要なフォルダーをリンク、参照および選択します。 次をクリック： **追加** ボタンをクリックして、シリアル化タスクリストにフォルダーを追加します。

   >[!NOTE]
   >
   > 1 つのシリアル化タスクに複数のフォルダーを選択して追加できます。

1. 「**開始**」をクリックします。

1. メタデータ抽出を確認ダイアログで、「 **OK**.


## 検索結果から一時ファイルを除外 {#id197AHI0035Z}

デフォルトでは、検索はAEMのリポジトリ全体で実行されます。 検索から除外したい場所が存在する場合があります。 例えば、コンテンツ翻訳ワークフローを開始しても、未承認のファイルは一時フォルダーの場所に残ります。 検索を実行すると、この一時的な場所のファイルも検索結果に返されます。

AEMガイドが一時的な翻訳フォルダーの場所を検索しないようにするには、除外リストに一時フォルダーの場所を追加する必要があります。

一時的な翻訳フォルダーを検索から除外するには、次の手順を実行します。

>[!NOTE]
>
> この手順を使用して、除外リストに他のフォルダの場所を追加できます。 インデックスの操作について詳しくは、 [コンテンツの検索とインデックス作成](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/operations/indexing.html?lang=ja).

1. カスタム damAssetLucene インデックスに次のプロパティを追加します。

   | プロパティ名 | タイプ | 値 |
   |-------------|----|-----|
   | excludedPaths | 文字列\[\] | このプロパティに次の値を追加します。<br> `/content/dam/projects/translation\_output` |

1. 次の場所にある Lucene ノードに移動します。

   /oak:index/lucene

1. Lucene ノードに次のプロパティを追加します。

   | プロパティ名 | タイプ | 値 |
   |-------------|----|-----|
   | excludedPaths | 文字列\[\] | このプロパティに次の値を追加します。<br> `/content/dam/projects/translation\_output` |
