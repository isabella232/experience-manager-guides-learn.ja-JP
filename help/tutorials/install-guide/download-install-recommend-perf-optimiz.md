---
title: Recommendations （パフォーマンス最適化）
description: パフォーマンス最適化のためのRecommendationsについて説明します
source-git-commit: 880cd344ceb65ea339be699ebcad41c0d62e168a
workflow-type: tm+mt
source-wordcount: '967'
ht-degree: 0%

---

# Recommendations （パフォーマンス最適化） {#id213BD0JG0XA}

## データストアを設定\（必須\）

**何が変わるの？**
を設定します。 `minRecordLength` プロパティを `100` 設定の下で `org.apache.jackrabbit.oak.plugins.blob.datastore.FileDataStore.` ファイルの日付ストアと S3 データストアについて詳しくは、 [AEM 6 でのノードストアとデータストアの設定](https://helpx.adobe.com/experience-manager/6-5/sites/deploying/using/data-store-config.html) 記事。

>[!NOTE]
>
> S3 データストアの場合、データストアでのコンテンツの保守にかかるコストもリクエスト数によって異なります。 したがって、S3 を使用してこの設定を行う場合は、リクエストあたりの設定コストとキャッシュサイズも考慮する必要があります。

**いつ設定しますか？**
初期設定後（ただし、コンテンツが移行される前）。 この変更は、既存のシステムでも実行する必要があります。これにより、すべての新しいコンテンツが、セグメントストアではなくデータストアに保存されます。

**この変更の結果**
DITA ファイルは、セグメントストアではなく、データストアに保存されます。 これにより、セグメントストアのサイズが推奨の制限を下回るので、システムの応答性が向上します。

## Lucene インデックスの更新\（必須\）

**何が変わるの？**
oak:index/lucene から/var/dxml を除外します。

>[!NOTE]
>
> AEMガイドは、Lucene インデックスを使用して/var/dxml ノード内のコンテンツを検索することはありません。

**いつ設定しますか？**
コンテンツを移行する前に新しいシステムでこの変更を行う場合は、oak:index/lucene の更新のみが必要です。 それ以外の場合は、コンテンツが既に移行されている既存のシステム上で、oak:index/lucene で変更を行った後、Lucene のインデックスを再構築します\(*完了するのに数時間かかる場合があります*\) です。

**この変更の結果**
この変更により、/var/dxml ノードがセグメントストアにインデックスを作成して保存されるのを防ぎます。

## Java メモリの最適化\（必須\）

**何が変わるの？**
JVM 開始パラメーターは、インフラストラクチャとディスクサイズに基づいて慎重に調整する必要があります。 理想的な設定にアクセスするヘルプを取得するには、Adobeサポートに問い合わせることをお勧めします。 ただし、次の設定を自分で試すことはできます。

- JVM ヒープサイズを、使用可能なメモリの合計の 4 分の 1 以上に設定します。 パラメーターの使用 `-Xmx<size>` ヒープメモリのサイズを設定します。  — の値を設定します。`Xms` 次と等しい `-Xmx`.

 — 有効 `-XX:+HeapDumpOnOutOfMemoryError` をクリックし、 `-XX:HeapDumpPath=</path/to/folder``>`.

- Java GC ログを次の形式で有効にします。

`* -XX:+PrintGCDateStamps`

`* -verbose:gc`

`* -XX:+PrintGCDetails`

`* -XX:+PrintTenuringDistribution`

`* -Xloggc:</path/to/gc.log>`

 — 一般に、Java 11 の場合は、G1GC \(`-XX:+UseG1GC`\) および Java 8 の場合は、CMS を使用します\(-`XX:+UseConcMarkSweepGC`\) です。

 — 用途 `-XX:NewRatio` 若い世代のメモリサイズを制御する。 デフォルト値は 2 です。つまり、メモリの 1/3 が若い世代に使用されます。 素早く作成および破壊されるオブジェクトが多いので、1 の値を使用すると、若い世代にメモリの 1/2 が割り当てられます。

 — 古い世代にプロモートされるオブジェクトの数を次を使用して制御 `-XX:MaxTenuringThreshold`. オブジェクトが古い世代にプロモートされる際に遅延するには、値 15（デフォルト）を使用します。

**いつ設定しますか？**
既存のシステムでこの変更を行う場合は、システムを再起動する必要があります。 新規インストールの場合、この変更は、システムが起動する前に起動スクリプト\（.bat または.sh\）ファイルで行う必要があります。

**この変更の結果**
これにより、最適なヒープサイズと GC の実行が規制されます。

## オーサーインスタンスでのクライアントライブラリの縮小\（オプション\）

**何が変わるの？**
クライアントライブラリは、オーサリングインスタンスで縮小するように設定する必要があります。 これにより、ユーザーが別の場所からシステムを参照する際に、ダウンロードするバイト数が少なくなります。 この変更を行うには、 **HTMLライブラリマネージャー** Felix コンソールから

**いつ設定しますか？**
これは、Felix コンソールを通じて実行時に、またはコードのデプロイメントを通じておこなうことができます。

**この変更の結果**
この変更により、クライアントライブラリの読み込み用に転送されるバイト数が少なくなるので、オーサーインスタンスでのページの読み込み時間が短縮されます。

## 同時公開スレッドを設定\（使用事例に応じて必須）

**何が変わるの？**
この変更は、DITA-OT を使用して出力を公開し、多数の同時公開スレッドも定義する場合に必要です。

デフォルトでは、AEMガイドは公開スレッドを CPU+1 の数に設定します。 ただし、この値は CPU の総数の半分 (1/2) または 3 分の 1(1/3) に設定することをお勧めします。 これをおこなうには、 **生成プールのサイズ** プロパティを設定の下に配置します。 `com.adobe.fmdita.publish.manager.PublishThreadManagerImpl` 推奨事項に従って

**いつ設定しますか？**
これは、Felix コンソールを通じて実行時に、またはコードのデプロイメントを通じておこなうことができます。

**この変更の結果**
この変更により、実行中のオーサーインスタンスでは、すべてのリソースが公開操作に割り当てられなくなります。 これにより、作成者もシステムリソースを使用できるようになり、ユーザーエクスペリエンスが向上します。

## AEM Site の出力生成用にノードのバッチサイズを設定\（使用例に応じて必須\）

**何が変わるの？**
この変更は、AEM Sites出力を生成する場合に必要です。

を設定します。 **ヒープ内のAEMサイトページの制限** 下のプロパティ `com.adobe.fmdita.config.ConfigManager` を、システムの設定に基づく数値に変更します。 このプロパティは、サイトページの生成時にコミットするノードのバッチサイズを定義します。 例えば、CPU とヒープサイズが多いシステムでは、 `500` をより大きな数に変更します。 このプロパティの最適な値になるには、変更した値で実行をテストする必要があります。

**いつ設定しますか？**
これは、Felix コンソールを通じて実行時に、またはコードのデプロイメントを通じておこなうことができます。

**この変更の結果**
この **ヒープ内のAEMサイトページの制限** プロパティにより、AEM Site の出力生成プロセスが最適化されます。

## 後処理スレッドの数の最適化\（使用例に応じて必須\）

**何が変わるの？**
この変更は、DITA コンテンツを一括アップロードする場合に必要です。

を設定します。 **後処理Threads** 下のプロパティ `com.adobe.fmdita.config.ConfigManager` から `1`.

**いつ設定しますか？**
これは、実行時に実行できます。

**この変更の結果**
この変更により、DITA ファイルの一括アップロード時の後処理時間が短縮されました。

**親トピック：**[&#x200B;ダウンロードとインストール](download-install.md)
