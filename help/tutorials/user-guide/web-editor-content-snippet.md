---
title: データソースからコンテンツスニペットを挿入する
description: AEM Guides のデータソースのデータを使用します。 データソースからコンテンツスニペットを挿入する方法を説明します。 トピックジェネレーターを使用してトピックを作成します。
exl-id: fbd5eff2-451b-49d6-ba77-6eb271e94349
source-git-commit: f7a0140a274a83dfeb6a1ba70ae9c09297d1754c
workflow-type: tm+mt
source-wordcount: '2060'
ht-degree: 0%

---

# データソースのデータを使用する

A **データソース** は、組織のデータを保存および管理するシステムです。 JIRA、SQL データベース、PIM、PLM などの記録システムです。 AEMガイドでは、データソースに接続し、それらのデータを使用する機能を提供します。

## データソースパネル

選択 **データソース** ![](images/data-source-icon.svg) （左側のパネル）に、接続されているデータソースが表示されます。 Data Sources パネルが開き、接続されているすべてのデータソースが表示されます。

管理者は、設定に基づいてデータソースコネクタを設定できます。

<details>
<summary> Cloud Services </summary>


- 2023 年 10 月リリース以降を使用している場合は、以下の方法を参照してください。 [ユーザーインターフェイスからのデータソースコネクタの設定](../cs-install-guide/conf-data-source-connector-tools.md) (『Cloud Serviceのインストールと設定ガイド』) を参照してください。

- 2023 年 7 月または 2023 年 9 月リリースを使用している場合は、以下の方法を参照してください。 [データソースコネクタの設定](../cs-install-guide/conf-data-source-connector.md) (『Cloud Serviceのインストールと設定ガイド』) を参照してください。

</details>

<details>    
<summary>  オンプレミスソフトウェア </summary>

- 4.3.1 リリース以降を使用している場合は、以下を実行する方法を確認してください。 [ユーザーインターフェイスからのデータソースコネクタの設定](../cs-install-guide/conf-data-source-connector-tools.md) （『オンプレミスのインストールと設定ガイド』）を参照してください。

- 4.3 リリースを使用している場合は、以下を実行する方法を確認してください。 [データソースコネクタの設定](../cs-install-guide/conf-data-source-connector.md) （『オンプレミスのインストールと設定ガイド』）を参照してください。
</details>


>[!NOTE]
>
> 管理者がコネクタを設定したデータソースが表示されます。


## リストビューまたはタイルビューを表示する

リスト表示とタイル表示を切り替えて、様々なデータソースをリスト形式で表示するか、タイル形式で表示するかを切り替えることができます。

データソースを選択して、選択したデータソースで使用できるコンテンツスニペットジェネレーターとトピックジェネレーターを表示します。

### リスト表示  ![](images/data-sources-list-view-icon.svg)

![](images/data-sources-list-view.png){width="300" align="left"}

*接続されたデータソースのリスト。*

### タイル表示   ![](images/data-sources-tile-view-icon.svg)

![](images/data-sources-tile-view.png){width="300" align="left"}

*接続されたデータソースをタイルとして表示します。*

データソースのデータは、次の 2 つの方法で使用できます。
- コンテンツスニペットを挿入
- トピックの作成



## データソースからコンテンツスニペットを挿入する

AEMガイドでは、データソースに接続する機能を提供します。 データを取得し、トピックに挿入して編集できます。 コンテンツスニペットジェネレーターを使用して、コンテンツスニペットを簡単に作成し、トピック内で再利用できます。

コンテンツスニペットジェネレーターを使用してコンテンツスニペットを作成し、トピックに挿入するには、次の手順を実行します。

1. 選択 **データソース** ![](images/data-source-icon.svg)   （左側のパネル）に、接続されているデータソースが表示されます。

1. データソースを選択して、選択したデータソースで使用可能なコンテンツスニペットジェネレーターを表示します。

   ![](images/code-snippet-generator.png){width="300" align="left"}
   *データソースパネルに、使用可能なコンテンツスニペットジェネレーターが一覧表示されます。*

1. 選択 **追加** 新しいコンテンツスニペットジェネレーターを追加するには、次の手順に従います。 The **コンテンツスニペットジェネレーターを追加** パネルが開きます。

1. 「データクエリー」テキストボックスにクエリーを入力します。
1. データソースとマッピングするテンプレートを、 **データマッピングテンプレート** ドロップダウン。
選択したデータソースの標準テンプレートがドロップダウンに表示されます。 例えば、「PostgreSQL」データソース用の「sql-table」テンプレートを表示できます。

   >[!NOTE]
   >  
   > 管理者がカスタマイズしたテンプレートを設定している場合は、（管理者がおこなったテンプレートパス設定に基づいて）ドロップダウンリストにもこれらのテンプレートが表示されます。
   >   
   >また、テンプレートで Velocity ツールを使用することもできます。 方法の詳細 [Velocity ツールの使用](#use-velocity-tools).

1. クリック **取得** をクリックしてデータソースからデータを取得し、SQL クエリの結果のデータにテンプレートを適用します。

1. データは、プレビューまたは DITA ソース表示で表示できます。

   1. プレビューでは、コンテンツにデータを挿入したときのデータの表示方法を確認できます。 プレビューには、選択したテンプレートの形式で、データのごく一部が表示されます。
例：
      - SQL-table テンプレートを選択した場合は、SQL データを表形式で表示できます。
      - Jira 順序付きリストテンプレートを選択した場合は、Jira の問題に関する順序付きリストを表示できます。

   1. ソース・ビューには、DITA ソース・ビューのデータが表示されます。
      ![](images/add-content-snippet-generator.png){width="800" align="left"}
      *コンテンツスニペットジェネレーターを追加します。 データをソースモードまたはプレビューモードで表示します。*

1. クエリの結果を保存するには、ジェネレーターの名前を入力し、 **追加**.   新しいコンテンツスニペットジェネレーターがリストに追加されます。

   >[!NOTE]
   >
   > 新しいコンテンツジェネレーターの名前は、ファイル命名規則に従う必要があります。 コンテンツスニペットジェネレーターの名前にスペースを含めることはできません。 また、既存のコンテンツジェネレーターの名前を持つ新しいコンテンツジェネレーターを保存することはできません。 エラーが発生しました。

### コンテンツスニペットジェネレーターのオプション

コンテンツスニペットジェネレーターを右クリックして、オプションを開きます。 オプションを使用して、次の操作を実行できます。

- **プレビュー**：パネルを開き、出力でのデータの表示方法のごく一部を表示するには、このオプションを使用します。
- **挿入**：このオプションを使用して、Web エディターで編集用に開かれたトピックに、選択したコンテンツスニペットを挿入します。 データがスニペットとして挿入されると、Web エディターでトピック内のデータを編集することもできます。

  >[!NOTE]
  > 
  > 挿入オプションは、トピックの編集中にのみ表示されます。

- **編集**：コンテンツスニペットジェネレーターで変更を加え、保存するには、このオプションを使用します。
- **削除**：選択したコンテンツスニペットジェネレーターを削除するには、このオプションを使用します。
- **複製**：選択したコンテンツスニペットジェネレーターの複製またはコピーを作成するには、このオプションを使用します。 複製は、デフォルトでサフィックス（generator_1 など）を付けて作成されます。

### クエリスニペットを挿入

また、 **クエリスニペットの挿入** ![](images/data-source-icon.svg)   をメインツールバーから選択し、データスニペットをトピックに挿入します。  ドロップダウンからジェネレーターを選択したり、クエリを編集したり、テンプレートを変更してトピックにデータを挿入したりできます。

![](images/insert-content-snippet.png){width="800" align="left"}

*データスニペットを編集して挿入します。*

## トピックジェネレーターを使用したトピックの作成

トピックジェネレーターを使用すると、ソースのデータを含むトピックを作成できます。 トピックジェネレーターをすばやく作成し、ジェネレーターを使用してトピックを生成できます。 各トピックには、テーブル、リスト、段落など、様々な形式のデータを含めることができます。   例えば、トピックで、すべての新しい製品の詳細と、販売を中止するすべての製品のリストを含むテーブルを追加できます。

トピックジェネレーターは、すべてのトピックのデータと DITA マップを含むトピックを作成できます。 また、 `<conref>` コンテンツ内のこれらのトピック。 これにより、データをデータソースと同期した状態に保ち、簡単に更新できます。



### トピックの作成

トピックジェネレーターを使用してトピックを作成するには、次の手順を実行します。

1. データソースを選択して、選択したデータソースで使用できるコンテンツスニペットジェネレーターとトピックジェネレーターを表示します。

   ![](images/data-sources.png){width="300" align="left"}

   *接続されたデータソースに対してトピックジェネレーターを追加します。*

1. 選択 **追加** ![](images/Add_icon.svg) を選択し、 **トピックジェネレーター** 新しいトピックジェネレーターを追加するには、ドロップダウンからを選択します。 The **トピックジェネレーターを追加** パネルが開きます。



1. 次の 3 つのタブの下にあるフィールドに値を入力します。 **トピックジェネレーターを追加** パネル：

   **設定を取得**

   ![](images/topic-generator-fetch-configuration.png){width="300" align="left"}

   *トピックジェネレーターのデータクエリ、データマッピングテンプレート、ルートノードの詳細を追加し、「設定を取得」パネルで一意の名前を付けます。*

   1. クエリを **データクエリ** テキストボックス。
   1. データソースとマッピングするテンプレートを、 **データマッピングテンプレート** ドロップダウン。

      >[!NOTE]
      >
      > 管理者がカスタマイズしたテンプレートを設定している場合は、（管理者がおこなったテンプレートパス設定に基づいて）ドロップダウンリストにもこれらのテンプレートが表示されます。 例えば、順序付きリスト、表、段落、その他の DITA 要素を含むトピックテンプレートを作成できます。

   1. 次を入力します。 **ルートノード**. これは、データにアクセスするノードです。 次に、トピックジェネレーターは、ルートノードで定義されたレベルで各トピックを作成します。 例えば、Jira のルートノードに「issues」を追加できます。 したがって、クエリが 13 件の問題を返した場合、13 件のトピックが取得され、各問題に対して 1 件のトピックが取得されます。

   1. クリック **取得** をクリックしてデータソースからデータを取得し、SQL クエリの結果のデータにテンプレートを適用します。 プレビューでは、選択したテンプレートの形式でトピックが表示される部分が表示されます。 例えば、クエリで生成されたすべてのフィールドに関する 1 つの Jira 問題を表示できます。
   1. トピックジェネレーターの名前を入力します。

      >[!NOTE]
      > 
      > 新しいトピックジェネレーターの名前には、ファイルの命名規則に従う必要があります。 トピックジェネレーターの名前にスペースを含めることはできません。 また、既存のトピックジェネレーターの名前を持つ新しいトピックジェネレーターを保存することはできません。 エラーが発生しました。

   **出力の設定**

   ![](images/topic-generator-output-configuration.png){width="300" align="left"}

   *出力設定パネルに、出力パスおよびトピック命名規則の詳細を入力します。 DITA マップを生成し、名前を付けます。*

   1. 次を入力します。 **出力パス** トピックを保存する場所の詳細。
   1. Adobe Analytics の **トピックの命名規則**&#x200B;に値を指定する場合は、velocity タグ付きの値または変数を入力できます。 新しいトピックは、規則に従います。 例えば、 `$key` をクリックして、Jira キーに基づいてトピックを作成します。
   1. オプションを有効にする **マップを生成する** 生成されたすべてのトピックを含むマップを作成する場合。
   1. 新しい DITA マップの名前を入力します。

   >[!NOTE]
   >
   > トピックジェネレーターは、トピックと同じ出力パスに DITA マップを生成します。

   **メタデータ**

   トピックに渡すメタデータのプロパティをドロップダウンから選択します。 **名前** ドロップダウンリストには、カスタムプロパティとデフォルトプロパティの両方が表示されます。

   例えば、次のスクリーンショットでは、 `dc:description`, `dc:language`, `dc:title`、および `docstate` は、値を定義できるデフォルトのプロパティです。 author などのカスタムプロパティを作成し、その値を定義できます。

   ![](images/topic-generator-metadata.png){width="300" align="left"}

   *トピックに渡すメタデータプロパティをメタデータパネルに追加します。*

1. ジェネレーターの名前を入力し、 **保存** をクリックしてクエリ結果を保存します。 新しいトピックジェネレーターがリストに追加されます。

1. クリック **保存して生成** トピックジェネレータを保存し、トピックジェネレータから新しいトピックを生成する。



   ![](images/edit-topic-generator.png){width="650" align="left"}

   *既存のトピックジェネレーターから新しいトピックを生成します。*

   >[!NOTE]
   >
   > トピックが既に存在する場合、ジェネレーターは既存のトピックのデータを更新します。

### トピックジェネレーターのオプション

トピックジェネレーターを右クリックして、 **オプション**. オプションを使用して、次の操作を実行できます。

- **生成**：このオプションを選択すると、選択したトピックジェネレーターのトピックが生成されます。 このオプションを使用して、既存のトピックを更新することもできます。 データソースに接続し、更新されたデータを取得します。 コンテンツの生成時には、このオプションは無効になり、ローダが表示されます。
  >[!NOTE]
  >
  >トピックが既に存在する場合は、トピック内のデータを上書きするか、新しいバージョンとして保存できます。

  ![](images/generate-topic-options.png)

  *トピックを生成し、既にファイルが存在する場合は、新しいバージョンとして保存するか、上書きします。*
- **ログを表示**：コンテンツ生成ログファイルを表示するには、このオプションを選択します。 ログファイルが新しいタブで開きます。 エラー、警告、情報メッセージ、および例外をログファイルに表示できます。 このオプションは、選択したトピックジェネレーター用にコンテンツを生成した場合に有効になります。

- **プレビュー**：パネルを開き、出力でのデータの表示方法のごく一部を表示するには、このオプションを使用します。



- **編集**：このオプションを使用して、トピックジェネレーターを変更して保存します。 コンテンツの生成中は、このオプションは無効になります。
- **削除**：このオプションを使用して、選択したトピックジェネレーターを削除します。 コンテンツの生成中は、このオプションは無効になります。
- **複製**：選択したトピックジェネレーターの複製またはコピーを作成します。 重複は、次のようなサフィックスで作成されます `topic-sample_1`) をデフォルトで使用します。



## データソーステンプレートでの Velocity ツールの使用 {#use-velocity-tools}

Experience Managerテンプレートは、Velocity ツール（バージョン 2.0）もサポートしています。 これらのツールを使用すると、データソースから取得するデータに様々な関数を適用できます。 の使用に関する詳細 [Velocity ツール](https://velocity.apache.org/tools/2.0/generic.html) および適用できる関数を示します。

テンプレートで Velocity ツールを使用するには、次の手順を実行します。
1. Web エディタで Velocity テンプレートを編集します。
1. にツールとその機能を追加します。 `<tool.function>` 形式を使用します。 例：
   - 数式ツールを使用して乱数を生成するには、 `$mathTool.random`.
   - 数学ツールを使用して数の合計を生成するには、 `$mathTool.add(num1, num2)`.
1. テンプレートを使用して、コンテンツスニペットまたはトピックを作成します。
1. テンプレートをデータに適用した後、プレビューまたは DITA ソース表示でデータを表示できます。




Velocity テンプレート内で次のツールを使用して、コネクタから取得するデータに様々な機能を適用できます。`$alternatorTool`
- `$classTool`
- `$contextTool`
- `$conversionTool`
- `$dateTool`
- `$comparisonDateTool`
- `$displayTool`
- `$escapeTool`
- `$fieldTool`
- `$loopTool`
- `$linkTool`
- `$listTool`
- `$mathTool`
- `$numberTool`
- `$renderTool`
- `$resourceTool`
- `$sortTool`
